# ACT Policy Configuration with Pri3D Visual Encoder
# Alternative configuration using Pri3D ResNet encoder instead of CLIP

name: act

# Visual Encoder Configuration (Pri3D)
encoder:
  name: pri3d
  variant: resnet50           # resnet18, resnet34, or resnet50
  pretrained: false           # Set to true if using pretrained Pri3D weights
  ckpt_path: null             # Path to Pri3D checkpoint (if pretrained=true)
  out_dim: 512
  freeze: false               # Can train Pri3D encoder jointly with ACT
  fuse: concat_mlp              # Learnable fusion: bilinear, gated, concat_mlp, or mean

# ACT Architecture Hyperparameters
chunk_size: 50              # Number of future actions to predict in each forward pass
temporal_context: 3         # Number of past observations to use as context
hidden_dim: 512             # Transformer hidden dimension (d_model)
nheads: 8                   # Number of attention heads in transformer
num_encoder_layers: 4       # Number of transformer encoder layers
num_decoder_layers: 7       # Number of transformer decoder layers (ACT uses more decoder layers)
dim_feedforward: 3200       # Dimension of feedforward network in transformer
latent_dim: 32              # Dimension of CVAE latent variable
dropout: 0.1                # Dropout rate in transformer

# Training Hyperparameters
kl_weight: 10.0             # Weight for KL divergence loss (controls latent regularization)
lr: 1.0e-5                  # Learning rate (Adam optimizer)
batch_size: 200              # Training batch size
num_epochs: 150         # Number of training epochs (may need more for end-to-end training)
action_loss: l1             # Action loss type: 'l1' or 'l2'

# Validation & Checkpointing
checkpoint_frequency: 10    # Save checkpoint every N epochs
val_split: 0.1              # Fraction of data for validation

# Inference Settings
temporal_ensemble: true     # Use temporal ensembling during evaluation
ensemble_window: 10         # Window size for temporal ensembling

# Data Preprocessing
# Note: Use build_image_transform(kind="imagenet", size=224) for preprocessing
image_size: 224
preprocess_kind: imagenet   # 'clip' or 'imagenet' depending on encoder

# Camera Configuration
camera_names:
  - wrist_cam_left
  - wrist_cam_right
